var wishlist_button;!function(){var t={9976:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return u.default}});var n=h(i(7041)),s=h(i(543)),o=h(i(829)),r=h(i(1654)),a=h(i(9995)),u=h(i(5507)),d=h(i(1840)),c=h(i(4683)),l=h(i(6856));function h(t){return t&&t.__esModule?t:{default:t}}},5380:function(t,e){"use strict";function i(t){return 14+(t+64>>>9<<4)+1}function n(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function s(t,e,i,s,o,r){return n((a=n(n(e,t),n(s,r)))<<(u=o)|a>>>32-u,i);var a,u}function o(t,e,i,n,o,r,a){return s(e&i|~e&n,t,e,o,r,a)}function r(t,e,i,n,o,r,a){return s(e&n|i&~n,t,e,o,r,a)}function a(t,e,i,n,o,r,a){return s(e^i^n,t,e,o,r,a)}function u(t,e,i,n,o,r,a){return s(i^(e|~n),t,e,o,r,a)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let i=0;i<e.length;++i)t[i]=e.charCodeAt(i)}return function(t){const e=[],i=32*t.length,n="0123456789abcdef";for(let s=0;s<i;s+=8){const i=t[s>>5]>>>s%32&255,o=parseInt(n.charAt(i>>>4&15)+n.charAt(15&i),16);e.push(o)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[i(e)-1]=e;let s=1732584193,d=-271733879,c=-1732584194,l=271733878;for(let e=0;e<t.length;e+=16){const i=s,h=d,v=c,f=l;s=o(s,d,c,l,t[e],7,-680876936),l=o(l,s,d,c,t[e+1],12,-389564586),c=o(c,l,s,d,t[e+2],17,606105819),d=o(d,c,l,s,t[e+3],22,-1044525330),s=o(s,d,c,l,t[e+4],7,-176418897),l=o(l,s,d,c,t[e+5],12,1200080426),c=o(c,l,s,d,t[e+6],17,-1473231341),d=o(d,c,l,s,t[e+7],22,-45705983),s=o(s,d,c,l,t[e+8],7,1770035416),l=o(l,s,d,c,t[e+9],12,-1958414417),c=o(c,l,s,d,t[e+10],17,-42063),d=o(d,c,l,s,t[e+11],22,-1990404162),s=o(s,d,c,l,t[e+12],7,1804603682),l=o(l,s,d,c,t[e+13],12,-40341101),c=o(c,l,s,d,t[e+14],17,-1502002290),d=o(d,c,l,s,t[e+15],22,1236535329),s=r(s,d,c,l,t[e+1],5,-165796510),l=r(l,s,d,c,t[e+6],9,-1069501632),c=r(c,l,s,d,t[e+11],14,643717713),d=r(d,c,l,s,t[e],20,-373897302),s=r(s,d,c,l,t[e+5],5,-701558691),l=r(l,s,d,c,t[e+10],9,38016083),c=r(c,l,s,d,t[e+15],14,-660478335),d=r(d,c,l,s,t[e+4],20,-405537848),s=r(s,d,c,l,t[e+9],5,568446438),l=r(l,s,d,c,t[e+14],9,-1019803690),c=r(c,l,s,d,t[e+3],14,-187363961),d=r(d,c,l,s,t[e+8],20,1163531501),s=r(s,d,c,l,t[e+13],5,-1444681467),l=r(l,s,d,c,t[e+2],9,-51403784),c=r(c,l,s,d,t[e+7],14,1735328473),d=r(d,c,l,s,t[e+12],20,-1926607734),s=a(s,d,c,l,t[e+5],4,-378558),l=a(l,s,d,c,t[e+8],11,-2022574463),c=a(c,l,s,d,t[e+11],16,1839030562),d=a(d,c,l,s,t[e+14],23,-35309556),s=a(s,d,c,l,t[e+1],4,-1530992060),l=a(l,s,d,c,t[e+4],11,1272893353),c=a(c,l,s,d,t[e+7],16,-155497632),d=a(d,c,l,s,t[e+10],23,-1094730640),s=a(s,d,c,l,t[e+13],4,681279174),l=a(l,s,d,c,t[e],11,-358537222),c=a(c,l,s,d,t[e+3],16,-722521979),d=a(d,c,l,s,t[e+6],23,76029189),s=a(s,d,c,l,t[e+9],4,-640364487),l=a(l,s,d,c,t[e+12],11,-421815835),c=a(c,l,s,d,t[e+15],16,530742520),d=a(d,c,l,s,t[e+2],23,-995338651),s=u(s,d,c,l,t[e],6,-198630844),l=u(l,s,d,c,t[e+7],10,1126891415),c=u(c,l,s,d,t[e+14],15,-1416354905),d=u(d,c,l,s,t[e+5],21,-57434055),s=u(s,d,c,l,t[e+12],6,1700485571),l=u(l,s,d,c,t[e+3],10,-1894986606),c=u(c,l,s,d,t[e+10],15,-1051523),d=u(d,c,l,s,t[e+1],21,-2054922799),s=u(s,d,c,l,t[e+8],6,1873313359),l=u(l,s,d,c,t[e+15],10,-30611744),c=u(c,l,s,d,t[e+6],15,-1560198380),d=u(d,c,l,s,t[e+13],21,1309151649),s=u(s,d,c,l,t[e+4],6,-145523070),l=u(l,s,d,c,t[e+11],10,-1120210379),c=u(c,l,s,d,t[e+2],15,718787259),d=u(d,c,l,s,t[e+9],21,-343485551),s=n(s,i),d=n(d,h),c=n(c,v),l=n(l,f)}return[s,d,c,l]}(function(t){if(0===t.length)return[];const e=8*t.length,n=new Uint32Array(i(e));for(let i=0;i<e;i+=8)n[i>>5]|=(255&t[i/8])<<i%32;return n}(t),8*t.length))}},8077:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};e.default=i},9995:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default="00000000-0000-0000-0000-000000000000"},6856:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=(n=i(1840))&&n.__esModule?n:{default:n};e.default=function(t){if(!(0,s.default)(t))throw TypeError("Invalid UUID");let e;const i=new Uint8Array(16);return i[0]=(e=parseInt(t.slice(0,8),16))>>>24,i[1]=e>>>16&255,i[2]=e>>>8&255,i[3]=255&e,i[4]=(e=parseInt(t.slice(9,13),16))>>>8,i[5]=255&e,i[6]=(e=parseInt(t.slice(14,18),16))>>>8,i[7]=255&e,i[8]=(e=parseInt(t.slice(19,23),16))>>>8,i[9]=255&e,i[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=e/4294967296&255,i[12]=e>>>24&255,i[13]=e>>>16&255,i[14]=e>>>8&255,i[15]=255&e,i}},1573:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},4553:function(t,e){"use strict";let i;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)};const n=new Uint8Array(16)},719:function(t,e){"use strict";function i(t,e,i,n){switch(t){case 0:return e&i^~e&n;case 1:case 3:return e^i^n;case 2:return e&i^e&n^i&n}}function n(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t){const e=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const o=t.length/4+2,r=Math.ceil(o/16),a=new Array(r);for(let e=0;e<r;++e){const i=new Uint32Array(16);for(let n=0;n<16;++n)i[n]=t[64*e+4*n]<<24|t[64*e+4*n+1]<<16|t[64*e+4*n+2]<<8|t[64*e+4*n+3];a[e]=i}a[r-1][14]=8*(t.length-1)/Math.pow(2,32),a[r-1][14]=Math.floor(a[r-1][14]),a[r-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<r;++t){const o=new Uint32Array(80);for(let e=0;e<16;++e)o[e]=a[t][e];for(let t=16;t<80;++t)o[t]=n(o[t-3]^o[t-8]^o[t-14]^o[t-16],1);let r=s[0],u=s[1],d=s[2],c=s[3],l=s[4];for(let t=0;t<80;++t){const s=Math.floor(t/20),a=n(r,5)+i(s,u,d,c)+l+e[s]+o[t]>>>0;l=c,c=d,d=n(u,30)>>>0,u=r,r=a}s[0]=s[0]+r>>>0,s[1]=s[1]+u>>>0,s[2]=s[2]+d>>>0,s[3]=s[3]+c>>>0,s[4]=s[4]+l>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,255&s[0],s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,255&s[1],s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,255&s[2],s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,255&s[3],s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,255&s[4]]}},4683:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.unsafeStringify=r;var n,s=(n=i(1840))&&n.__esModule?n:{default:n};const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function r(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}e.default=function(t,e=0){const i=r(t,e);if(!(0,s.default)(i))throw TypeError("Stringified UUID is invalid");return i}},7041:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=(n=i(4553))&&n.__esModule?n:{default:n},o=i(4683);let r,a,u=0,d=0;e.default=function(t,e,i){let n=e&&i||0;const c=e||new Array(16);let l=(t=t||{}).node||r,h=void 0!==t.clockseq?t.clockseq:a;if(null==l||null==h){const e=t.random||(t.rng||s.default)();null==l&&(l=r=[1|e[0],e[1],e[2],e[3],e[4],e[5]]),null==h&&(h=a=16383&(e[6]<<8|e[7]))}let v=void 0!==t.msecs?t.msecs:Date.now(),f=void 0!==t.nsecs?t.nsecs:d+1;const y=v-u+(f-d)/1e4;if(y<0&&void 0===t.clockseq&&(h=h+1&16383),(y<0||v>u)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=v,d=f,a=h,v+=122192928e5;const p=(1e4*(268435455&v)+f)%4294967296;c[n++]=p>>>24&255,c[n++]=p>>>16&255,c[n++]=p>>>8&255,c[n++]=255&p;const _=v/4294967296*1e4&268435455;c[n++]=_>>>8&255,c[n++]=255&_,c[n++]=_>>>24&15|16,c[n++]=_>>>16&255,c[n++]=h>>>8|128,c[n++]=255&h;for(let t=0;t<6;++t)c[n+t]=l[t];return e||(0,o.unsafeStringify)(c)}},543:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i(1629)),s=o(i(5380));function o(t){return t&&t.__esModule?t:{default:t}}var r=(0,n.default)("v3",48,s.default);e.default=r},1629:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(t,e,i){function n(t,n,r,a){var u;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i));return e}(t)),"string"==typeof n&&(n=(0,o.default)(n)),16!==(null===(u=n)||void 0===u?void 0:u.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let d=new Uint8Array(16+t.length);if(d.set(n),d.set(t,n.length),d=i(d),d[6]=15&d[6]|e,d[8]=63&d[8]|128,r){a=a||0;for(let t=0;t<16;++t)r[a+t]=d[t];return r}return(0,s.unsafeStringify)(d)}try{n.name=t}catch(t){}return n.DNS=r,n.URL=a,n};var n,s=i(4683),o=(n=i(6856))&&n.__esModule?n:{default:n};const r="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=r;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=a},829:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(i(8077)),s=r(i(4553)),o=i(4683);function r(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,i){if(n.default.randomUUID&&!e&&!t)return n.default.randomUUID();const r=(t=t||{}).random||(t.rng||s.default)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){i=i||0;for(let t=0;t<16;++t)e[i+t]=r[t];return e}return(0,o.unsafeStringify)(r)}},1654:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i(1629)),s=o(i(719));function o(t){return t&&t.__esModule?t:{default:t}}var r=(0,n.default)("v5",80,s.default);e.default=r},1840:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=(n=i(1573))&&n.__esModule?n:{default:n};e.default=function(t){return"string"==typeof t&&s.default.test(t)}},5507:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=(n=i(1840))&&n.__esModule?n:{default:n};e.default=function(t){if(!(0,s.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}},5725:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventAggregationEventType=void 0,(e.EventAggregationEventType||(e.EventAggregationEventType={})).WEBSOCKET_SERVICE_READY="WebsocketServiceReady"},423:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},8759:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},6570:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebsocketServiceReadyEvent=void 0;const n=i(5725);class s{constructor(t){this.eventAggregationService=t,this.eventType=s.EventType,this.timestamp=new Date}}e.WebsocketServiceReadyEvent=s,s.EventType=n.EventAggregationEventType.WEBSOCKET_SERVICE_READY},3385:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),s(i(3400),e),s(i(423),e),s(i(8759),e),s(i(6570),e),s(i(5725),e)},3400:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},8328:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),s(i(3385),e),s(i(4285),e),s(i(3519),e)},3974:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},3112:function(t,e){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.SessionServiceEventType=void 0,(i=e.SessionServiceEventType||(e.SessionServiceEventType={})).SESSION_SERVICE_READY="SessionServiceReady",i.SESSION_CREATED="SessionCreated",i.SESSION_DESTROYED="SessionDestroyed"},3641:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionCreatedEvent=void 0;const n=i(3112);class s{constructor(t){this.eventType=s.EventType,this.timestamp=new Date,this.session=t}}e.SessionCreatedEvent=s,s.EventType=n.SessionServiceEventType.SESSION_CREATED},3533:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionDestroyedEvent=void 0;const n=i(3112);class s{constructor(){this.eventType=s.EventType,this.timestamp=new Date}}e.SessionDestroyedEvent=s,s.EventType=n.SessionServiceEventType.SESSION_DESTROYED},9927:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionServiceReadyEvent=void 0;const n=i(3112);class s{constructor(t){this.eventType=s.EventType,this.timestamp=new Date,this.sessionService=t}}e.SessionServiceReadyEvent=s,s.EventType=n.SessionServiceEventType.SESSION_SERVICE_READY},4285:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),s(i(4024),e),s(i(8615),e),s(i(4256),e),s(i(2781),e),s(i(3974),e),s(i(5386),e),s(i(9927),e),s(i(3533),e),s(i(3641),e),s(i(3112),e)},4024:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},5386:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},4256:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},8615:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},2781:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},2301:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},9258:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistServiceEventType=void 0,(e.WishlistServiceEventType||(e.WishlistServiceEventType={})).WISHLIST_SERVICE_READY="WishlistServiceReady"},6549:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistServiceReadyEvent=void 0;const n=i(9258);class s{constructor(t){this.wishlistService=t,this.eventType=s.EventType,this.timestamp=new Date}}e.WishlistServiceReadyEvent=s,s.EventType=n.WishlistServiceEventType.WISHLIST_SERVICE_READY},3519:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),s(i(2301),e),s(i(6549),e)},4073:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(2755)),n(i(9290))},9057:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?s(t.value):new i((function(e){e(t.value)})).then(r,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=i(9290),o=i(9397),r=i(8576);class a extends r.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}validate(t){if("number"!=typeof t.studyId)throw new o.FavouriteInvalidStudyId(t.studyId)}handle({studyId:t,userId:e,expectedState:i}){return n(this,void 0,void 0,(function*(){try{this.validate({studyId:t,userId:e,expectedState:i});const n=yield this.getWishlist(e,i),o=s.Favourite.create(t);return n.addFavourite(o),yield this.wishlistRepository.addFavourite(n,o),yield this.emitFavouriteAddedEvent(e,t,o.dateAdded),{resultingState:n.stateHash}}catch(t){if(t instanceof s.StudyAlreadyFavourited)return{resultingState:i};throw t}}))}emitFavouriteAddedEvent(t,e,i){return n(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(s.FavouriteAdded.EventType,s.FavouriteAdded.create(t,e,i))}))}}e.DefaultAddToWishlistCommandHandler=a},796:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddToWishlistCommand=class{constructor(t,e,i){this.userId=t,this.studyId=e,this.expectedState=i}}},8856:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(796)),n(i(9057))},8576:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?s(t.value):new i((function(e){e(t.value)})).then(r,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=i(9290);e.BaseWishlistCommandHandler=class{constructor(t){this.wishlistRepository=t,this.wishlistStateValidator=new s.WishlistStateValidator}getWishlist(t,e){return n(this,void 0,void 0,(function*(){const i=yield this.wishlistRepository.retrieveByUserId(t);if(null===i)throw new s.WishlistNotFound(t);return this.wishlistStateValidator.validate(i,e),i}))}}},884:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommandResult=class{constructor(t){this.resultingState=t}}},4083:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}(i(884))},5274:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(7738)),n(i(9481)),n(i(3699))},9481:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?s(t.value):new i((function(e){e(t.value)})).then(r,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=i(3699);e.DefaultGetWishlistQueryHandler=class{constructor(t){this.wishlistRepository=t}handle({userId:t}){return n(this,void 0,void 0,(function*(){let e=yield this.wishlistRepository.retrieveByUserId(t);return null===e&&(e=yield this.wishlistRepository.createWishlist(t)),new s.GetWishlistQueryResult(e)}))}}},3699:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GetWishlistQueryResult=class{constructor(t){this.wishlist=t}}},7738:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GetWishlistQuery=class{constructor(t){this.userId=t}}},2755:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(8856)),n(i(1803)),n(i(5274)),n(i(214)),n(i(4083))},7986:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?s(t.value):new i((function(e){e(t.value)})).then(r,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=i(9290),o=i(9397),r=i(8576);class a extends r.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}validate(t){if("number"!=typeof t.studyId)throw new o.FavouriteInvalidStudyId(t.studyId)}handle({studyId:t,userId:e,expectedState:i}){return n(this,void 0,void 0,(function*(){try{this.validate({studyId:t,userId:e,expectedState:i});const n=yield this.getWishlist(e,i);n.removeFavourite(t);const o=this.getCurrentDate();return yield this.wishlistRepository.removeFavourite(n,s.Favourite.create(t),o),yield this.emitFavouriteRemovedEvent(e,t,o),{resultingState:n.stateHash}}catch(t){if(t instanceof s.FavouriteNotFound)return{resultingState:i};throw t}}))}getCurrentDate(){return new Date}emitFavouriteRemovedEvent(t,e,i){return n(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(s.FavouriteRemoved.EventType,s.FavouriteRemoved.create(t,e,i))}))}}e.DefaultRemoveFromWishlistCommandHandler=a},182:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RemoveFromWishlistCommand=class{constructor(t,e,i){this.userId=t,this.studyId=e,this.expectedState=i}}},1803:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(182)),n(i(7986))},4706:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?s(t.value):new i((function(e){e(t.value)})).then(r,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=i(9290),o=i(5865),r=i(8576);class a extends r.BaseWishlistCommandHandler{constructor(t,e){super(t),this.wishlistRepository=t,this.eventEmitter=e}handle({userId:t,targetStudyId:e,position:i,expectedState:o}){return n(this,void 0,void 0,(function*(){const n=yield this.getWishlist(t,o);let r=null;if(0!==i){if(!n.favourites[i])throw new s.WishlistException("Position out of bounds");r=n.favourites[i].study.id}return n.changeOrder(e,r),yield this.wishlistRepository.setWishlistOrder(n,e,r),yield this.emitWishListOrderChangedEvent(t,e,r,new Date),{resultingState:n.stateHash}}))}emitWishListOrderChangedEvent(t,e,i,s){return n(this,void 0,void 0,(function*(){yield this.eventEmitter.emit(o.WishlistOrderChanged.EventType,o.WishlistOrderChanged.create(t,e,i,s))}))}}e.SetWishlistOrderCommandHandler=a},3456:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SetWishlistOrderCommand=class{constructor(t,e,i,n){this.userId=t,this.targetStudyId=e,this.position=i,this.expectedState=n}}},214:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(3456)),n(i(4706))},9497:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4806);class s{constructor(t,e){this.study=t,this.dateAdded=e}static create(t,e=new Date){return new s(new n.Study(t),e)}}e.Favourite=s},8772:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(9497)),n(i(4806)),n(i(6200))},4806:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Study=class{constructor(t,e){this.id=t,this.card=e}canShowProgrammeCard(){return!!this.card}setProgrammeCard(t){this.card=t}}},6200:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(8862),s=i(7073);e.Wishlist=class{constructor(t){this.userId=t,this._favourites=[]}get favourites(){return this._favourites}get stateHash(){const t=this._favourites.map((t=>t.study.id));return s.StateHasher.hash(t)}changeOrder(t,e){if(t===e)throw new n.WishlistException("targetStudy cannot be the same study as referenceStudy");if(!this.isFavourited(t))throw new n.WishlistException("targetStudy does not exist");let i=-1;const s=this.removeAndRetrieveFavouriteFromFavourites(t);if(e){if(!this.isFavourited(e))throw new n.WishlistException("referenceStudy does not exist");i=this.favourites.findIndex((t=>t.study.id===e))}this.favourites.splice(i+1,0,s)}removeAndRetrieveFavouriteFromFavourites(t){const e=this.favourites.findIndex((e=>e.study.id===t)),i=this.favourites[e];return this.favourites.splice(e,1),i}addFavourite(t){if(this.containsStudy(t.study.id))throw new n.StudyAlreadyFavourited(this.userId,t.study.id);this._favourites.push(t)}removeFavourite(t){this.removeStudyFromFavourites(t)}containsStudy(t){return this._favourites.some((e=>e.study.id===t))}findFavourite(t){return this._favourites.find((e=>e.study.id===t))||null}removeStudyFromFavourites(t){let e=!1;if(this._favourites=this._favourites.filter((i=>{const n=i.study.id===t;return n&&(e=!0),!n})),!e)throw new n.FavouriteNotFound(this.userId,t)}toJSON(){return{userId:this.userId,favourites:this._favourites}}isFavourited(t){return this._favourites.some((e=>e.study.id===t))}}},6513:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4928);class s extends n.WishlistEvent{constructor(t,e,i,n){super(n),this.userId=t,this.studyId=e,this.eventId=i,this.dateAdded=n,this.eventType=s.EventType,this.eventVersion="1.0.0"}static create(t,e,i=new Date){return new s(t,e,n.WishlistEvent.generateId(),i)}}s.EventType="FavouriteAdded",e.FavouriteAdded=s},8209:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4928);class s extends n.WishlistEvent{constructor(t,e,i,n){super(n),this.userId=t,this.studyId=e,this.eventId=i,this.dateRemoved=n,this.eventType=s.EventType,this.eventVersion="1.0.0"}static create(t,e,i){return new s(t,e,n.WishlistEvent.generateId(),i)}}s.EventType="FavouriteRemoved",e.FavouriteRemoved=s},5865:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(6513)),n(i(8209)),n(i(1298))},4928:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(9976);e.WishlistEvent=class{constructor(t){this.timestamp=t}static generateId(){return n.v4()}}},1298:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4928);class s extends n.WishlistEvent{constructor(t,e,i,n,o){super(o),this.userId=t,this.targetStudyId=e,this.referenceStudyId=i,this.eventId=n,this.dateChanged=o,this.eventType=s.EventType,this.eventVersion="1.0.0"}static create(t,e,i,o=new Date){return new s(t,e,i,n.WishlistEvent.generateId(),o)}}s.EventType="WishlistOrderChanged",e.WishlistOrderChanged=s},8647:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(){super("Favourite found without a study"),this.name="FavouriteFoundWithoutStudy"}}e.FavouriteFoundWithoutStudy=s},9397:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(t){super(`Invalid study id, expected to be of type number: ${JSON.stringify(t)}`),this.studyId=t,this.name="FavouriteInvalidStudyId"}}e.FavouriteInvalidStudyId=s},447:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(t,e){super(`Favourite with study id ${e} from wishlist ${t} not found.`),this.name="FavouriteNotFound"}}e.FavouriteNotFound=s},739:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(){super("ExpectedState doesn't match current state of wishlist"),this.name="IncorrectWishlistState"}}e.IncorrectWishlistState=s},8862:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(8647)),n(i(447)),n(i(739)),n(i(8180)),n(i(9094)),n(i(3720))},8180:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(t,e){super(`Favourite with study id ${e} from wishlist ${t} already exists.`),this.wishlistId=t,this.studyId=e,this.name="StudyAlreadyFavourited"}}e.StudyAlreadyFavourited=s},3720:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i extends Error{constructor(t){super(t),this.name="WishlistException"}}e.WishlistException=i},9094:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3720);class s extends n.WishlistException{constructor(t){super(`Wishlist with id ${t} not found`),this.wishlistId=t,this.name="WishlistNotFound"}}e.WishlistNotFound=s},9290:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(8772)),n(i(8862)),n(i(7073)),n(i(5865))},7073:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(2386)),n(i(709))},2386:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(2783);e.StateHasher=class{static hash(t){return n(JSON.stringify(t)).toString()}}},709:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(739);e.WishlistStateValidator=class{validate(t,e){if(t.stateHash!==e)throw new n.IncorrectWishlistState}}},8249:function(t,e){var i;t.exports=(i=i||function(t,e){var i=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),n={},s=n.lib={},o=s.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=s.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,s=t.sigBytes;if(this.clamp(),n%4)for(var o=0;o<s;o++){var r=i[o>>>2]>>>24-o%4*8&255;e[n+o>>>2]|=r<<24-(n+o)%4*8}else for(o=0;o<s;o+=4)e[n+o>>>2]=i[o>>>2];return this.sigBytes+=s,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i,n=[],s=function(e){var i=987654321,n=4294967295;return function(){var s=((i=36969*(65535&i)+(i>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return s/=4294967296,(s+=.5)*(t.random()>.5?1:-1)}},o=0;o<e;o+=4){var a=s(4294967296*(i||t.random()));i=987654071*a(),n.push(4294967296*a()|0)}return new r.init(n,e)}}),a=n.enc={},u=a.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],s=0;s<i;s++){var o=e[s>>>2]>>>24-s%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new r.init(i,e/2)}},d=a.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],s=0;s<i;s++){var o=e[s>>>2]>>>24-s%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new r.init(i,e)}},c=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},l=s.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,s=i.sigBytes,o=this.blockSize,a=s/(4*o),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,d=t.min(4*u,s);if(u){for(var c=0;c<u;c+=o)this._doProcessBlock(n,c);var l=n.splice(0,u);i.sigBytes-=d}return new r.init(l,d)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(s.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new h.HMAC.init(t,i).finalize(e)}}}),n.algo={});return n}(Math),i)},2783:function(t,e,i){var n,s,o,r,a,u,d,c;t.exports=(s=(n=c=i(8249)).lib,o=s.WordArray,r=s.Hasher,a=n.algo,u=[],d=a.SHA1=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],s=i[1],o=i[2],r=i[3],a=i[4],d=0;d<80;d++){if(d<16)u[d]=0|t[e+d];else{var c=u[d-3]^u[d-8]^u[d-14]^u[d-16];u[d]=c<<1|c>>>31}var l=(n<<5|n>>>27)+a+u[d];l+=d<20?1518500249+(s&o|~s&r):d<40?1859775393+(s^o^r):d<60?(s&o|s&r|o&r)-1894007588:(s^o^r)-899497514,a=r,r=o,o=s<<30|s>>>2,s=n,n=l}i[0]=i[0]+n|0,i[1]=i[1]+s|0,i[2]=i[2]+o|0,i[3]=i[3]+r|0,i[4]=i[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=r._createHelper(d),n.HmacSHA1=r._createHmacHelper(d),c.SHA1)},3744:function(t,e){"use strict";e.Z=(t,e)=>{const i=t.__vccOpts||t;for(const[t,n]of e)i[t]=n;return i}},1549:function(t,e,i){t.exports=i(4717)("v")},4717:function(t){"use strict";t.exports=vue3_library_v5}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};!function(){"use strict";i.r(n);var t=i(1549);const e={key:0,class:"Favouriting"},s=["aria-label"];var o=(0,t.reactive)({areDependenciesLoaded:!1,isReady:!1,wishlist:[],error:null,loggedIn:!1,bnwModeActive:!1}),r={isReady:()=>g.state.isReady,wishlistLimitReached:()=>o.wishlist.length>=99,bnwModeActive:()=>o.bnwModeActive,isLoggedIn:()=>o.loggedIn},a={setAreDependenciesLoaded:t=>{o.areDependenciesLoaded=t},setIsReady:t=>{o.isReady=t},handleErrorState:()=>{o.error="sync_error"},triggerBNWMode:()=>{o.bnwModeActive=!0},setLoggedInState:t=>{o.loggedIn=t},addFavourite:t=>{const e=[...o.wishlist];e.push({study:{id:t}}),o.wishlist=e},removeFavourite:t=>{const e=[...o.wishlist];o.wishlist=e.filter((e=>e.study.id!==t))},updateWishlistValue:t=>{o.wishlist=t}},u=i(4073),d={Wishlisting:"Wishlisting",Profile:"Profile"},c={FavouriteAdd:"favourite_add",FavouriteRemove:"favourite_remove",RegisterIncentiveClick:"Register Incentive Click"},l={FavouriteAdd:"Favourite add"};class h{constructor(){var t,e;e=void 0,(t="trackingDictionary")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.trackingDictionary={actions:c,categories:d,labels:l}}GA(t){return void 0===window.Shared||void 0===window.Shared.GA?null:void window.Shared.GA.fireTracker({category:t.category,action:t.action,label:t.label,value:t.value})}snowPlow(t){if(void 0===window.snowplow)return null;window.snowplow("trackStructEvent",t)}}var v={eventAggregationService:{},wishlistTracking:new h,wishlistService:{}};class f{async notify(){await this.updateWishlist()}async initiate(){v.eventAggregationService.subscribeTo(u.FavouriteAdded.EventType,this),v.eventAggregationService.subscribeTo(u.FavouriteRemoved.EventType,this),await this.updateWishlist(),g.mutations.setIsReady(!0)}async updateWishlist(){const t=await v.wishlistService.getWishlist();if(null===t)return;const e=t.favourites.slice(0);g.actions.updateWishlist(e)}}var y=i(8328);class p{get eventAggregationService(){return v.eventAggregationService}async notify(t){if(t.eventType===y.SessionServiceReadyEvent.EventType){const e=t;await this.onSessionServiceReady(e.sessionService)}if(t.eventType===y.SessionCreatedEvent.EventType){const e=t;g.actions.setLoggedInState(null!==e.session)}}initiate(){this.eventAggregationService.subscribeTo(y.SessionServiceReadyEvent.EventType,this,!0),this.eventAggregationService.subscribeTo(y.SessionCreatedEvent.EventType,this)}async onSessionServiceReady(t){const e=null!==await t.getSession();g.actions.setLoggedInState(e)}}const _={setAreDependenciesLoaded:async t=>{g.mutations.setAreDependenciesLoaded(t),t&&((new f).initiate(),(new p).initiate())},addFavourite:async t=>{r.wishlistLimitReached()?_.fireWishlistLimitReachedEvent():(a.addFavourite(t),await v.wishlistService.addFavourite(t))},removeFavourite:async t=>{a.removeFavourite(t),await v.wishlistService.removeFavourite(t)},updateWishlist:t=>{g.mutations.updateWishlistValue(t),_.fireWishlistSyncedEvent()},fireWishlistSyncedEvent:()=>{document.dispatchEvent(new Event("wishlist_synced"))},fireWishlistLimitReachedEvent:()=>{document.dispatchEvent(new CustomEvent("Notification",{detail:{key:"WishlistLimitReached"}}))},setLoggedInState:t=>{a.setLoggedInState(t)}};var m=_,g={state:(0,t.readonly)(o),mutations:a,getters:r,actions:m};function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class b{constructor(e,i,n){w(this,"study_id",void 0),w(this,"buttonType",void 0),w(this,"button_location",void 0),w(this,"root",(0,t.ref)(null)),w(this,"initialAnimationTimeout",45e3),w(this,"animationInterval",45e3),w(this,"animationTriggered",(0,t.ref)(!1)),w(this,"isAnimated",(0,t.ref)(!1)),w(this,"canAnimate",(0,t.ref)(!1)),w(this,"tracking",(0,t.computed)((()=>new h))),w(this,"studyId",(0,t.computed)((()=>parseInt(this.study_id)))),w(this,"buttonLocation",(0,t.computed)((()=>String(this.button_location)))),w(this,"isLoggedIn",(0,t.computed)((()=>g.getters.isLoggedIn()))),w(this,"wishlisted",(0,t.computed)((()=>g.state.wishlist.filter((t=>t.study.id===this.studyId.value)).length>0))),this.study_id=e,this.buttonType=i,this.button_location=n}created(){document.addEventListener("trigger_action_animations",(()=>{this.canAnimate.value=!0}))}favouriteStudy(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==e&&e.preventDefault(),this.wishlisted.value?this.removeFavourite():this.addFavourite(t)}animateButton(){this.animationTriggered.value||(this.animationTriggered.value=!0,setTimeout((()=>{this.shouldBeAnimated()&&this.toggleAnimation(),setInterval((()=>{this.shouldBeAnimated()&&this.toggleAnimation()}),this.animationInterval)}),this.initialAnimationTimeout))}toggleAnimation(){this.isAnimated.value=!0,setTimeout((()=>{this.isAnimated.value=!1}),2e3)}shouldBeAnimated(){return!!this.root.value&&this.root.value.classList.contains("OffCanvas")&&!this.wishlisted.value&&this.canAnimate.value}async addFavourite(t){t&&!1===this.isLoggedIn.value&&this.openRegistrationPopup(),await g.actions.addFavourite(this.studyId.value);const e=this.tracking.value.trackingDictionary.actions.FavouriteAdd;"string"==typeof e&&this.trackStudy(e),this.broadcastFavouriteAddedInteraction()}async removeFavourite(){await g.actions.removeFavourite(this.studyId.value);const t=this.tracking.value.trackingDictionary.actions.FavouriteRemove;"string"==typeof t&&this.trackStudy(t)}openRegistrationPopup(){document.dispatchEvent(new CustomEvent("RenderAuthenticationService",{detail:{referrer:"FavouriteStudy",tabToShow:"third_party_login"}})),this.trackIncentiveImpression(),this.showWishlistAfterRegistration()}showWishlistAfterRegistration(){const t=window.EventAggregationService;t&&t.subscribeTo(y.SessionCreatedEvent.EventType,{notify:()=>{document.dispatchEvent(new Event("openWishlistDrawer"))}})}trackStudy(t){const e={category:this.tracking.value.trackingDictionary.categories.Wishlisting,action:t,label:this.buttonType,property:this.buttonLocation.value,value:this.studyId.value};this.tracking.value.GA(e),this.tracking.value.snowPlow(e)}trackIncentiveImpression(){const t={category:this.tracking.value.trackingDictionary.categories.Profile,action:this.tracking.value.trackingDictionary.actions.RegisterIncentiveClick,label:this.tracking.value.trackingDictionary.labels.FavouriteAdd};this.tracking.value.GA(t),this.tracking.value.snowPlow(t)}broadcastFavouriteAddedInteraction(){document.dispatchEvent(new CustomEvent("favourite_added_interaction",{detail:{studyId:this.studyId.value}}))}}class S extends b{constructor(){var e,i,n;super(...arguments),e=this,i="openIncentive",n=(0,t.computed)((()=>g.getters.bnwModeActive())),i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n}shouldBeAnimated(){return!!this.root.value&&!this.wishlisted.value&&this.canAnimate.value}mounted(){"study_fixed_essential_information"!==this.button_location&&"study_essential_information"!==this.button_location||(this.initialAnimationTimeout=500,this.animationInterval=1e4,this.canAnimate.value=!0,this.animateButton(),document.addEventListener("bestfit_fit_saved",(()=>{this.animateButton()}))),document.addEventListener("wishlist_bnw_mode",(()=>{g.mutations.triggerBNWMode()})),document.dispatchEvent(new Event("wishlist_bnw_ready"))}}var E=(0,t.defineComponent)({props:{study_id:String,button_type:String,button_location:String},setup:e=>{const i=new S(e.study_id,e.button_type,e.button_location);return i.created(),(0,t.onMounted)(i.mounted.bind(i)),{openIncentive:i.openIncentive,wishlisted:i.wishlisted,favouriteStudy:i.favouriteStudy.bind(i),isAnimated:i.isAnimated,root:i.root}}}),O=i(3744),I=(0,O.Z)(E,[["render",function(e,i,n,o,r,a){return(0,t.openBlock)(),(0,t.createElementBlock)("button",{ref:"root",onClick:i[0]||(i[0]=t=>e.favouriteStudy(e.openIncentive,t)),class:(0,t.normalizeClass)(["IconOnlyButton",{"is-animated":e.isAnimated}]),"aria-label":e.wishlisted?"Remove from wishlist":"Add to wishlist"},[(0,t.createElementVNode)("i",{class:(0,t.normalizeClass)(["HeartIcon",e.wishlisted?"lnr-heart-full":"lnr-heart"])},null,2)],10,s)}],["__scopeId","data-v-62f93da3"]]);const P=["aria-label"],A={class:"ButtonText"};function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class j extends b{constructor(){super(...arguments),M(this,"offCanvas",(0,t.ref)(!0)),M(this,"threshold",(0,t.ref)(300))}mounted(){this.animateButton(),this.calculateThreshold(),window.addEventListener("scroll",(()=>{this.showOrHide()})),window.addEventListener("resize",(()=>{this.calculateThreshold()}))}showOrHide(){window.pageYOffset>this.threshold.value?this.offCanvas.value=!1:window.pageYOffset<this.threshold.value&&(this.offCanvas.value=!0)}calculateThreshold(){const t=document.getElementById("HeroContainer");t&&(this.threshold.value=t.clientHeight)}}var F=(0,t.defineComponent)({props:{study_id:String,button_type:String,button_location:String},setup:e=>{const i=new j(e.study_id,e.button_type,e.button_location);return i.created(),(0,t.onMounted)(i.mounted.bind(i)),{offCanvas:i.offCanvas,threshold:i.threshold,wishlisted:i.wishlisted,favouriteStudy:i.favouriteStudy.bind(i),isAnimated:i.isAnimated,showOrHide:i.showOrHide.bind(i),calculateThreshold:i.calculateThreshold.bind(i)}}}),W=(0,O.Z)(F,[["render",function(e,i,n,s,o,r){return(0,t.openBlock)(),(0,t.createElementBlock)("button",{onClick:i[0]||(i[0]=t=>e.favouriteStudy(!0)),class:(0,t.normalizeClass)([{OffCanvas:e.offCanvas,"is-animated":e.isAnimated},"FloatingWishlistButton"]),type:"button","aria-label":e.wishlisted?"Remove from wishlist":"Add to wishlist"},[(0,t.createElementVNode)("i",{class:(0,t.normalizeClass)(["HeartIcon",e.wishlisted?"lnr-heart-full":"lnr-heart"])},null,2),(0,t.createElementVNode)("span",A,(0,t.toDisplayString)(e.wishlisted?"Added to wishlist":"Add to wishlist"),1)],10,P)}],["__scopeId","data-v-3f1471f6"]]);class R extends b{mounted(){this.animateButton()}}var T=(0,t.defineComponent)({props:{study_id:String,button_type:String,button_location:String},setup:e=>{const i=new R(e.study_id,e.button_type,e.button_location);return i.created(),(0,t.onMounted)(i.mounted.bind(i)),{wishlisted:i.wishlisted,favouriteStudy:i.favouriteStudy.bind(i),isAnimated:i.isAnimated}}}),C=(0,O.Z)(T,[["render",function(e,i,n,s,o,r){return(0,t.openBlock)(),(0,t.createElementBlock)("button",{onClick:i[0]||(i[0]=t=>e.favouriteStudy(!0)),class:(0,t.normalizeClass)([{"is-animated":e.isAnimated},"ChampionButton StudyHeaderButton"])},[(0,t.createElementVNode)("i",{class:(0,t.normalizeClass)(["HeartIcon",e.wishlisted?"lnr-heart-full":"lnr-heart"])},null,2),(0,t.createTextVNode)(" "+(0,t.toDisplayString)(e.wishlisted?"Added to wishlist":"Add to wishlist"),1)],2)}],["__scopeId","data-v-af5a5e1c"]]),x=(0,t.defineComponent)({props:{study_id:String,button_type:String,button_location:String},setup:t=>{const e=new b(t.study_id,t.button_type,t.button_location);return e.created(),{wishlisted:e.wishlisted,favouriteStudy:e.favouriteStudy.bind(e)}}}),B=(0,O.Z)(x,[["render",function(e,i,n,s,o,r){return(0,t.openBlock)(),(0,t.createElementBlock)("button",{onClick:i[0]||(i[0]=t=>e.favouriteStudy(!0)),class:"ChampionButton BestFitButton"},[(0,t.createElementVNode)("i",{class:(0,t.normalizeClass)(["HeartIcon",e.wishlisted?"lnr-heart-full":"lnr-heart"])},null,2),(0,t.createTextVNode)(" "+(0,t.toDisplayString)(e.wishlisted?"Added to wishlist":"Add to wishlist"),1)])}],["__scopeId","data-v-19963ddd"]]),k=(0,t.defineComponent)({components:{IconOnly:I,Floating:W,StudyHeader:C,BestFit:B},props:{study_id:String,button_type:String,button_location:String},setup:e=>({isReady:(0,t.computed)((()=>g.getters.isReady())),study_id:e.study_id,button_type:e.button_type,button_location:e.button_location})}),D=(0,O.Z)(k,[["render",function(i,n,s,o,r,a){const u=(0,t.resolveComponent)("IconOnly"),d=(0,t.resolveComponent)("Floating"),c=(0,t.resolveComponent)("StudyHeader"),l=(0,t.resolveComponent)("BestFit");return i.isReady?((0,t.openBlock)(),(0,t.createElementBlock)("div",e,["icon_only"===i.button_type?((0,t.openBlock)(),(0,t.createBlock)(u,{key:0,study_id:i.study_id,button_type:i.button_type,button_location:i.button_location},null,8,["study_id","button_type","button_location"])):(0,t.createCommentVNode)("v-if",!0),"floating_button"===i.button_type?((0,t.openBlock)(),(0,t.createBlock)(d,{key:1,study_id:i.study_id,button_type:i.button_type,button_location:i.button_location},null,8,["study_id","button_type","button_location"])):(0,t.createCommentVNode)("v-if",!0),"study_header"===i.button_type?((0,t.openBlock)(),(0,t.createBlock)(c,{key:2,study_id:i.study_id,button_type:i.button_type,button_location:i.button_location},null,8,["study_id","button_type","button_location"])):(0,t.createCommentVNode)("v-if",!0),"best_fit"===i.button_type?((0,t.openBlock)(),(0,t.createBlock)(l,{key:3,study_id:i.study_id,button_type:i.button_type,button_location:i.button_location},null,8,["study_id","button_type","button_location"])):(0,t.createCommentVNode)("v-if",!0)])):(0,t.createCommentVNode)("v-if",!0)}]]),H={install:t=>{const e=window&&window.rollbar?new window.rollbar({accessToken:"6864dd520c3b41f59791ebd80b9e4565",captureUncaught:!1,captureUnhandledRejections:!1,payload:{environment:"prd"}}):null;t.config.errorHandler=t=>{if(null!==e)throw e.error(t),t}}};(new class{initialize(){const t=window.EventAggregationService;t&&(v.eventAggregationService=t,t.subscribeTo(y.WishlistServiceReadyEvent.EventType,this,!0))}async notify(t){await this.handleWishlistServiceReady(t)}async handleWishlistServiceReady(t){v.wishlistService=t.wishlistService,await g.actions.setAreDependenciesLoaded(!0)}}).initialize();const L=()=>{const e=document.querySelectorAll(".WishlistButton");for(const i of e){const e=i.getAttribute("data-study-id"),n=i.getAttribute("data-button-type"),s=i.getAttribute("data-button-location"),o=(0,t.createApp)({render:()=>(0,t.h)(D,{study_id:e,button_type:n,button_location:s})});o.use(H),o.mount(i)}document.dispatchEvent(new Event("wishlist_buttons_rendered"))};L(),document.addEventListener("wishlist_button_initialize",L)}(),wishlist_button=n}();
//# sourceMappingURL=bundle.38f3524a9280964eb93c.js.map